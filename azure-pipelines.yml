# Starter pipeline

trigger:
    branches:
      include:
        - main

pool:
  name: ec2-self-hosted

#variables:

#parameters:
#- name: envronment  
#  type: string  
#  default: dev
#  values:  
#  - dev
#  - stagging
#  - prod

stages:
- stage: CI_Stage
  displayName: 'Build Stage'
  jobs:
  - job: Lint
    displayName: 'Linting Job'
    steps:
    - checkout: self
    - script: |
        sudo apt-get update
        sudo apt-get install -y libpython3.9
      displayName: 'Install missing dependencies'
    - task: UsePythonVersion@0
      inputs:
        versionSpec: '3.9'
        addToPath: true
    - script: |
        python3.9 -m venv .venv
        source .venv/bin/activate
        pip install flake8
        flake8 src/feedback_backend/app.py
      displayName: 'Run Linting'